<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Borg-forsvar: Immunsimulering</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .flip-card { perspective: 1000px; height: 180px; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; cursor: pointer; }
        .active-defense { transform: rotateY(180deg); outline: 4px solid #facc15; border-radius: 10px; }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; flex-direction: column; border-radius: 10px; padding: 15px; text-align: center; }
        .flip-card-front { background-color: #3b82f6; color: white; }
        .flip-card-back { background-color: #1e3a8a; color: white; transform: rotateY(180deg); }
        #log-container { max-height: 200px; overflow-y: auto; }
    </style>
</head>
<body class="bg-gray-100 font-sans">

    <header class="bg-slate-800 text-white py-8 shadow-lg text-center">
        <h1 class="text-4xl font-bold italic">üõ°Ô∏è Forsvaret av Borgen</h1>
        <button onclick="startSimulation()" class="mt-4 bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-full transition-all transform hover:scale-105 shadow-xl">
            SEND INN BAKTERIE-H√ÜREN!
        </button>
    </header>

    <main class="max-w-6xl mx-auto p-6 grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        <div class="lg:col-span-2">
            <div id="content"></div>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-inner border-2 border-slate-200">
            <h2 class="text-xl font-bold mb-4 flex items-center">
                <span class="mr-2">üìú</span> Hendelsesforl√∏p
            </h2>
            <div id="log-container" class="space-y-3 italic text-gray-700">
                <p>Borgen er rolig. Ingen fiender i sikte...</p>
            </div>
        </div>

    </main>

    <script>
        const data = {
            "layers": [
                { "id": "muren", "bio": "Huden", "castle": "Borgmuren", "desc": "Fienden pr√∏ver √• klatre over, men muren er tett!" },
                { "id": "troll", "bio": "Makrofager", "castle": "Vakt-trollene", "desc": "Trollene v√•kner og spiser de f√∏rste inntrengerne!" },
                { "id": "speider", "bio": "Dendrittiske celler", "castle": "Speiderne", "desc": "Speiderne rir til hovedstaden med fiendens v√•penskjold." },
                { "id": "general", "bio": "T-hjelpeceller", "castle": "Generalen", "desc": "Generalen ser v√•penskjoldet og gir ordre om full mobilisering!" },
                { "id": "smi", "bio": "B-celler", "castle": "V√•pensmia", "desc": "Smien lager tusenvis av piler tilpasset akkurat denne fienden!" }
            ]
        };

        // Tegn kortene
        const content = document.getElementById('content');
        data.layers.forEach(role => {
            const card = document.createElement('div');
            card.className = "flip-card mb-4";
            card.id = `card-${role.id}`;
            card.innerHTML = `
                <div class="flip-card-inner shadow-md" id="inner-${role.id}">
                    <div class="flip-card-front">
                        <h3 class="text-xl font-bold">${role.castle}</h3>
                    </div>
                    <div class="flip-card-back">
                        <h3 class="text-lg font-bold">${role.bio}</h3>
                        <p class="text-xs">${role.desc}</p>
                    </div>
                </div>
            `;
            content.appendChild(card);
        });

        function addLog(msg, color="text-gray-700") {
            const log = document.getElementById('log-container');
            const p = document.createElement('p');
            p.className = `p-2 border-l-4 border-slate-300 bg-slate-50 ${color}`;
            p.innerText = msg;
            log.prepend(p);
        }

        async function startSimulation() {
            // Nullstill
            document.querySelectorAll('.flip-card-inner').forEach(c => c.classList.remove('active-defense'));
            document.getElementById('log-container').innerHTML = "";
            
            const steps = [
                { id: 'muren', msg: "‚öîÔ∏è Bakteriene angriper! De pr√∏ver √• finne hull i muren...", delay: 1000 },
                { id: 'troll', msg: "üëπ Inntrengere har kommet gjennom et s√•r! Vakt-trollene (Makrofager) angriper!", delay: 2000 },
                { id: 'speider', msg: "üèá Speiderne (Dendrittiske celler) fanger en fiende og rir til generalen!", delay: 2000 },
                { id: 'general', msg: "üëë Generalen (T-hjelpeceller) analyserer trusselen og roper p√• forsterkninger!", delay: 2000 },
                { id: 'smi', msg: "üèπ V√•pensmia (B-celler) pumper ut m√•lrettede antistoff-piler. Seieren er n√¶r!", delay: 2000 }
            ];

            for (const step of steps) {
                addLog(step.msg, "text-blue-900 font-semibold");
                document.getElementById(`inner-${step.id}`).classList.add('active-defense');
                await new Promise(r => setTimeout(r, step.delay));
            }
            
            addLog("‚úÖ Fienden er bekjempet! Bibliotekarene (Hukommelsesceller) arkiverer info.", "text-green-600 font-bold");
        }
    </script>
</body>
</html>
